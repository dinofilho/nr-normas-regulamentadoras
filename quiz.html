<!DOCTYPE html><html lang="pt-BR"><head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>Avaliação Teórica</title>
<style>
 body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",sans-serif;background:#0f172a;color:#e5e7eb;margin:0}
 .wrap{max-width:920px;margin:28px auto;padding:0 16px}
 .card{background:#0b1220;border:1px solid #1f2937;border-radius:14px;box-shadow:0 1px 2px rgba(0,0,0,.4);padding:20px}
 h1{margin:0 0 8px;font-size:26px}
 .row{display:flex;gap:12px;flex-wrap:wrap;margin:10px 0}
 .row input{flex:1 1 240px;padding:10px 12px;border:1px solid #334155;border-radius:10px;background:#0f172a;color:#e5e7eb}
 .q{border-top:1px dashed #334155;padding-top:14px;margin-top:14px}
 .q h3{font-size:16px;margin:0 0 8px}
 .opts label{display:block;margin:6px 0;cursor:pointer}
 .btn{background:#2563eb;color:#fff;border:0;border-radius:12px;padding:12px 18px;font-weight:600;cursor:pointer}
 .btn.secondary{background:#0891b2}
 .btn:disabled{opacity:.6;cursor:not-allowed}
 .msg{margin:12px 0;color:#f87171}.ok{color:#34d399}
</style>
</head><body>
<div class="wrap"><div class="card">
  <h1>Avaliação Teórica</h1>
  <div id="score" style="margin:4px 0 8px 0;">Nota: 0 | Acertos: 0/10</div>
  <div class="row">
    <input id="nome" placeholder="Nome completo">
    <input id="cpf" placeholder="CPF (000.000.000-00)">
    <input id="email" placeholder="(opcional) e-mail">
  </div>
  <div class="row">
    <label style="width:100%">Data da avaliação
      <input id="data" type="date" style="width:100%">
    </label>
  </div>
  <div id="quiz"></div>
  <div class="row" style="margin-top:18px">
    <button id="enviar" class="btn">Enviar respostas</button>
    <button id="btnComprovante" class="btn secondary" style="display:none">Baixar comprovante</button>
  </div>
  <div id="msg" class="msg"></div>
</div></div>

<script>
(function(){
  const QUESTIONS = {
    nr1:[{q:"Qual documento integra o GRO segundo a NR-1?",a:"PCMSO",b:"PPRA",c:"PGR",d:"PPP",ans:"c"},
         {q:"O PGR é composto por:",a:"Relatório financeiro e PCMSO",b:"Inventário de riscos e plano de ação",c:"CIPA e PPP",d:"SIPAT e atas",ans:"b"},
         {q:"O foco do GRO é:",a:"Gestão de riscos ocupacionais",b:"Gestão fiscal",c:"Gestão de RH",d:"TI",ans:"a"}],
    nr5:[{q:"Objetivo da CIPA (NR-5):",a:"Férias",b:"Promover SST",c:"Salários",d:"Emitir PPP",ans:"b"},
         {q:"Atribuição da CIPA:",a:"Comprar EPI",b:"Plano de trabalho de SST",c:"Pagar adicionais",d:"Emitir CAT",ans:"b"},
         {q:"Treinamento da CIPA é:",a:"Dispensável",b:"Obrigatório",c:"Só suplentes",d:"Só presidente",ans:"b"}],
    nr6:[{q:"EPI significa:",a:"Equipamento de Proteção Individual",b:"Equipe de Planejamento",c:"Estudo Perigo",d:"Escala Produção",ans:"a"},
         {q:"Quem fornece EPI:",a:"Empregado",b:"Empregador",c:"Governo",d:"CIPA",ans:"b"},
         {q:"EPI deve ter:",a:"CA válido",b:"Etiqueta",c:"Manual opcional",d:"Nada",ans:"a"}],
    nr10:[{q:"Tema da NR-10:",a:"Altura",b:"Confinado",c:"Segurança em eletricidade",d:"Ergonomia",ans:"c"},
          {q:"Treinamento básico mínimo:",a:"8h",b:"16h",c:"40h",d:"100h",ans:"c"},
          {q:"Documentação exigida:",a:"Prontuário das instalações",b:"Livro ponto",c:"Ata CIPA",d:"—",ans:"a"}],
    nr20:[{q:"Tema da NR-20:",a:"Inflamáveis e combustíveis",b:"Ruído",c:"Ergonomia",d:"Eletricidade",ans:"a"},
          {q:"Plano essencial:",a:"Resposta a emergências",b:"Férias",c:"PPP",d:"Livro-caixa",ans:"a"},
          {q:"Inventário da NR-20 deve:",a:"Ser ignorado",b:"Identificar perigos e controles",c:"Só EPIs",d:"Ergonomia",ans:"b"}],
    nr33:[{q:"Tema da NR-33:",a:"Altura",b:"Espaços confinados",c:"Máquinas",d:"Calor",ans:"b"},
          {q:"Acesso ao confinado:",a:"Qualquer um",b:"Treinado e autorizado",c:"Visitante",d:"Terceiro sem EPI",ans:"b"},
          {q:"Documento de entrada:",a:"PET",b:"Recibo",c:"Atestado",d:"Nota fiscal",ans:"a"}],
    nr35:[{q:"Tema da NR-35:",a:"Altura",b:"Eletricidade",c:"Explosivos",d:"Máquinas",ans:"a"},
          {q:"Altura mínima (NR-35):",a:"1,0 m",b:"1,5 m",c:"2,0 m",d:"3,0 m",ans:"c"},
          {q:"Antes do trabalho em altura:",a:"Nada",b:"AR, planejamento e sistema de proteção",c:"Só cinto",d:"Só escada",ans:"b"}]
  };

  const $=s=>document.querySelector(s);
  const p=new URLSearchParams(location.search);
  const curso=(p.get("curso")||"nr1").toLowerCase().replace(/[^a-z0-9]/g,"");
  const today=new Date(); $("#data").value=today.toISOString().slice(0,10);
  const btnComp=$("#btnComprovante");
  const msg=(t,ok=false)=>{const m=$("#msg"); m.textContent=t; m.className= ok?"msg ok":"msg";};

  function get10(base){
    const out=[]; if(!base||!base.length) return out;
    for(let i=0;i<10;i++){ const src=base[i%base.length]; out.push(i<base.length?src:{...src,q:src.q+" (var "+(i+1)+")"}); }
    return out;
  }

  function render(qs){
    const host=$("#quiz"); host.innerHTML="";
    qs.forEach((it,idx)=>{
      const qid=\`q\${idx+1}\`;
      const b=document.createElement("div");
      b.className="q";
      b.innerHTML=\`<h3>\${idx+1}. \${it.q}</h3>
      <div class="opts">
        \${["a","b","c","d"].map(k=>\`<label><input type="radio" name="\${qid}" value="\${k}"> \${it[k]}</label>\`).join("")}
      </div>\`;
      host.appendChild(b);
    });
  }

  function grade(qs){
    let ok=0; qs.forEach((it,idx)=>{ const sel=document.querySelector(\`input[name="q\${idx+1}"]:checked\`); if(sel&&sel.value===it.ans) ok++;});
    const nota=Math.round((ok/10)*100); $("#score").textContent=\`Nota: \${nota} | Acertos: \${ok}/10\`; return nota;
  }

  const base=QUESTIONS[curso]||[];
  const qs=get10(base);
  if(!qs.length){ msg("Curso inválido. Use ?curso=nr1,nr5,nr6,nr10,nr20,nr33,nr35."); document.getElementById("enviar").disabled=true; }
  else { render(qs); msg("Carregado. Responda e envie.",true); }

  function hash(s){let h=0; for(let i=0;i<s.length;i++){h=((h<<5)-h)+s.charCodeAt(i); h|=0;} return (h>>>0).toString(16); }

  document.getElementById("enviar").onclick=()=>{
    const nota=grade(qs);
    const nome=($("#nome").value||"").trim();
    const cpf=($("#cpf").value||"").trim();
    const email=($("#email").value||"").trim();
    const data=($("#data").value||"").trim();
    if(!nome || !cpf || !data){ alert("Preencha Nome, CPF e Data."); return; }

    const payload={curso, nome, cpf, email, data, nota, ver: hash(curso+nome+cpf+data+nota)};
    localStorage.setItem("cert_dados", JSON.stringify(payload));

    if(nota>=70){
      btnComp.style.display="inline-block";
      btnComp.onclick=()=>{ location.href="comprovante.html"; };
      alert("Respostas enviadas. Nota: "+nota+"%. Você pode baixar o comprovante.");
    }else{
      btnComp.style.display="none";
      alert("Respostas enviadas. Nota: "+nota+"% (necessário ≥ 70%).");
    }
  };
})();
</script>
</body></html>
